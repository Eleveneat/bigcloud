{% extends "base.html" %}

{% block content_head %}
    <div class="container-fluid am-cf">
        <div class="row">
            <div class="am-u-sm-12 am-u-md-12 am-u-lg-9">
                <div class="page-header-heading"><span class="am-icon-cloud page-header-heading-icon"></span> 云接入
                </div>
                <p class="page-header-description">维护一份小云白名单，用于控制小云接入的管理。</p>
            </div>
        </div>
    </div>
{% endblock content_head %}

{% block content_body %}
    <div class="row-content am-cf">
        <div class="widget am-cf">
            <div class="widget-head am-cf">
                <div class="widget-title am-fl">小云白名单</div>
                <div class="widget-function am-fr">
                    <a href="javascript:;" class="am-icon-cog"></a>
                </div>
            </div>
            <div class="widget-body am-fr">
                <div style="min-height: 400px;width: 98%;margin: auto" class="" id="tpl-echarts-A">
                    {#                    <table id="littlecloud-table" class="am-table am-table-striped am-table-bordered am-table-compact am-text-nowrap">#}
                    <table width="100%" id="littlecloud-table"
                           class="am-table am-table-compact am-table-striped tpl-table-black am-text-nowrap">
                        <thead>
                        <tr>
                            {#                            <th class="center"><label><input type="checkbox"/><span class="lbl"></span></label></th>#}
                            <th>接入权限</th>
                            <th>小云名称</th>
                            <th>小云主页</th>
                            <th>接入IP</th>
                            <th>接入端口</th>
                            <th>接入协议</th>
                            <th>联系邮箱</th>
                            <th>联系电话</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock content_body %}


{% block custom_script %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/amazeui.switch.css') }}"/>
    <script src="{{ url_for('static', filename='js/amazeui.switch.min.js') }}"></script>

    <script>
        (function () {
            var tableDic = {
                responsive: true,
                "lengthChange": false,
                "ajax": "api/littlecloud",
                "oLanguage": {// 汉化
                    "sLengthMenu": "每页显示 _MENU_ 条记录",
                    "sZeroRecords": "没有检索到数据",
                    "sSearch": "", // TODO 不知道为什么搜索框前面有文字的话，样式会换行，特别不好看。后期优化。
                },
                "columns": [
                    {"data": "is_connectible"},
                    {"data": "name"},
                    {"data": "url"},
                    {"data": "ip"},
                    {"data": "port"},
                    {"data": "protocol"},
                    {"data": "email"},
                    {"data": "phone"},
                    {"data": "operation"},
                ],
                "createdRow": function (row, data, index) {
                    var switchTemplate = '<input id="switch-{0}" type="checkbox" {1} data-size="xs" data-off-text="禁止" data-on-text="允许" data-on-color="success" data-off-color="danger" name="my-checkbox">'
                    if (data["is_connectible"]) {
                        switchTemplate = switchTemplate.format(data["id"], "checked")
                    } else {
                        switchTemplate = switchTemplate.format(data["id"], "")
                    }
                    $('td', row).eq(0).html(switchTemplate);
                },
                "columnDefs": [{
                    "targets": -1,
                    "data": null,
                    "defaultContent": '<button class="btn btn-success btn-xs pass-btn" style="margin-right:10px">通过</button>' +
                    '<button class="btn btn-danger btn-xs " data-toggle="modal" data-target="#deleteSource ">拒绝</button>',
                    "orderable": false,
                }],
                "initComplete": function() {
                    $('[name="my-checkbox"]').bootstrapSwitch();
                },
            };

            var table = $('#littlecloud-table').DataTable(tableDic);
        }());

{#        function switchTemplate(id) {#}
{#            #}
{#        }#}
    </script>
{% endblock custom_script %}